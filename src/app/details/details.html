<article>
  <a [routerLink]="['/']" class="back-link">‚Üê Volver al inicio</a>

  @if (housingLocation) {
    <section class="listing-details">
      <img class="listing-photo" [src]="housingLocation.photo" alt="Exterior photo of {{housingLocation.name}}">
      
      <div class="listing-info">
        <h2>{{ housingLocation.name }}</h2>
        <p class="location">üìç {{ housingLocation.city }}, {{ housingLocation.state }}</p>
        
        <div class="price-section">
          <span class="price">${{ housingLocation.price }}/mes</span>
          <span class="availability" [class.available]="housingLocation.available" [class.unavailable]="!housingLocation.available">
            {{ housingLocation.available ? '‚úì Disponible' : '‚úó No disponible' }}
          </span>
        </div>

        <div class="features">
          <h3>Caracter√≠sticas:</h3>
          <ul>
            <li>üè† {{ housingLocation.availableUnits }} unidades disponibles</li>
            @if (housingLocation.wifi) {
              <li>üì∂ WiFi incluido</li>
            } @else {
              <li>‚ùå Sin WiFi</li>
            }
            @if (housingLocation.laundry) {
              <li>üß∫ Lavander√≠a disponible</li>
            } @else {
              <li>‚ùå Sin lavander√≠a</li>
            }
          </ul>
        </div>

        <!-- CLIMA -->
        @if (weatherData) {
          <div class="weather-section">
            <h3>üå§Ô∏è Clima actual:</h3>
            <div class="weather-info">
              <img [src]="weatherData.current.condition.icon" alt="Weather icon">
              <div>
                <p class="temperature">{{ weatherData.current.temp_c }}¬∞C</p>
                <p class="condition">{{ weatherData.current.condition.text }}</p>
                <p class="feels-like">Sensaci√≥n t√©rmica: {{ weatherData.current.feelslike_c }}¬∞C</p>
              </div>
            </div>
          </div>
        } @else {
          <div class="weather-section">
            <p>‚è≥ Cargando informaci√≥n del clima...</p>
          </div>
        }
      </div>
    </section>
  }

  <!-- FORMULARIO DE SOLICITUD -->
  <section class="application-form">
    <h2>Solicitar informaci√≥n</h2>
    <p class="form-description">Complete el formulario para recibir m√°s informaci√≥n sobre esta propiedad.</p>
    
    <form [formGroup]="applyForm" (ngSubmit)="submitApplication()">
      <div class="form-group">
        <label for="first-name">Nombre *</label>
        <input 
          id="first-name" 
          type="text" 
          formControlName="firstName"
          [class.invalid]="isFieldInvalid('firstName')"
          placeholder="Ingresa tu nombre">
        @if (isFieldInvalid('firstName')) {
          <span class="error-message">{{ getErrorMessage('firstName') }}</span>
        }
      </div>

      <div class="form-group">
        <label for="last-name">Apellido *</label>
        <input 
          id="last-name" 
          type="text" 
          formControlName="lastName"
          [class.invalid]="isFieldInvalid('lastName')"
          placeholder="Ingresa tu apellido">
        @if (isFieldInvalid('lastName')) {
          <span class="error-message">{{ getErrorMessage('lastName') }}</span>
        }
      </div>

      <div class="form-group">
        <label for="email">Email *</label>
        <input 
          id="email" 
          type="email" 
          formControlName="email"
          [class.invalid]="isFieldInvalid('email')"
          placeholder="ejemplo@email.com">
        @if (isFieldInvalid('email')) {
          <span class="error-message">{{ getErrorMessage('email') }}</span>
        }
      </div>

      <button type="submit" class="primary" [disabled]="applyForm.invalid">
        Enviar solicitud
      </button>
    </form>

    <p class="form-note">* Los datos del formulario se guardar√°n autom√°ticamente en tu navegador</p>
  </section>
</article>